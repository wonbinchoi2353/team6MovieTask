<!--리뷰 목록-->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>영화 상세 페이지</title>
    <link rel="stylesheet" href="/style/style.css" />
    <script src="/src/util/review.js" defer></script>
</head>
<style>
    .review-box {
        background-color: #ccac5b;
        width: 300px;
        height: 180px;
        margin: 10px auto;

        text-align: center;
    }

    .review-list {
        display: flex;
        display: grid;
        justify-content: center;
        grid-template-rows: repeat(auto-fill, minmax(0, 1fr));
        gap: 30px;
        padding: 50px;
    }

    .review {
        background-color: #ccac5b;
        width: 300px;
        padding: 20px;
        text-align: left;
        word-wrap: break-word;
    }
</style>

<body>
    <h1 class="details-title">스파이더맨</h1>
    <div class="review-box">
        <div>
            <p><label for="">작성자</label><input type="text" class="writer" /></p>
            <p><label for="">확인비밀번호</label><input type="text" class="password" /></p>
            <textarea class="review-text" name="" id="" cols="30" rows="5"></textarea>
            <button class="review-btn">리뷰 등록하기</button>
        </div>
        <div class="review-list"></div>
    </div>



    <!------------------------------------------------>








    <ul id="review-list"></ul>

    <script>
        //리뷰 목록 불러오기
        //페이지 로드 시 로컬 스토리지에서 리뷰 목록 불러오기
        window.addEventListener('load', function () {
            displayReviews();
        });

        //리뷰 추가 버튼 클릭시 호출되는 함수 리팩토링?
        //function addReview() {
        // let review = prompt('리뷰를 입력하세요.');
        // if (review) {
        //     //로컬 스토리지에 리뷰 추가
        //     let reviews = getReviews();
        //     reviews.push(review);
        //     localStorage.setItem('reviews', JSON.stringify(reviews));

        //리뷰 목록 다시 표시
        // displayReviews();


        //리뷰 삭제 버튼 클릭 시 호출되는 함수
        function deleteReview(index) {
            let reviews = getReviews();
            reviews.splice(index, 1);
            localStorage.setItem('reviews', JSON.stringify(reviews));

            //리뷰 목록 다시 표시 -왜?
            displayReviews();
        }
        // 로컬 스토리지에서 리뷰 목록 가져오는 함수
        function getReviews() {
            let reviews = localStorage.getItem('reviews');
            return reviews ? JSON.parse(reviews) : [];
        }

        // 리뷰 목록을 동적으로 표시하는 함수 -왜?
        function displayReviews() {
            let reviewList = document.getElementById('review-list');
            reviewList.innerHTML = '';

            let reviews = getReviews();
            for (let comment = 0; comment < reviews.length; comment++) {
                let review = reviews[comment];

                let li = document.createElement('li');
                li.textContent = review;

                //삭제버튼
                let deleteButton = document.createElement('button');
                deleteButton.textContent = '삭제';
                deleteButton.addEventListener('click', (function (index) {
                    return function () {
                        deleteReview(index);

                    };
                })(comment));

                li.appendChild(deleteButton);
                reviewList.appendChild(li);

            }
        }


    </script>